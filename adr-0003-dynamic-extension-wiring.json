{"version":3,"kind":"Article","sha256":"3b02e00de715eedf9e2ebe22d21d8ab59ab4442ded23ad86953672b748164434","slug":"adr-0003-dynamic-extension-wiring","location":"/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","dependencies":[],"frontmatter":{"title":"ADR-0003 Dynamic Extension Wiring and Subprocess Execution","date":"2026-02-27","label":"devflow.developer-guide.design.adr-0003","authors":[{"nameParsed":{"literal":"Soft Mentor","given":"Soft","family":"Mentor"},"name":"Soft Mentor","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/softmentor/devflow","abbreviations":{"ADR":"Architecture Decision Record.","API":"Application Programming Interface.","CI":"Continuous Integration.","CLI":"Command Line Interface.","DAG":"Directed Acyclic Graph.","GHCR":"GitHub Container Registry.","PR":"Pull Request."},"numbering":{"title":{"offset":3}},"source_url":"https://github.com/softmentor/devflow/blob/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","edit_url":"https://github.com/softmentor/devflow/edit/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","exports":[{"format":"md","filename":"adr-0003-dynamic-extension-wiring.md","url":"/devflow/build/adr-0003-dynamic-ext-c8db7fe119727366ad6078a960b6c907.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"abbreviation","title":"Architecture Decision Record.","children":[{"type":"text","value":"ADR","key":"r2NPUcuvPX"}],"key":"OGaLykKx1j"},{"type":"text","value":"-0003: Dynamic Extension Wiring and Subprocess Execution","key":"jebl9vidWb"}],"identifier":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","label":"ADR-0003: Dynamic Extension Wiring and Subprocess Execution","html_id":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","implicit":true,"key":"G8XeoFliDT"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Context","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UmPrZ73fT8"}],"identifier":"context","label":"Context","html_id":"context","implicit":true,"key":"mSJdAnNZT1"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Devflow needs to support multiple language stacks (","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"xrnVNWjYSU"},{"type":"inlineCode","value":"rust","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EMMk0fLyj3"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"eizb2E0fpR"},{"type":"inlineCode","value":"node","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FJ5ioVsTbX"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"UGejLT5woI"},{"type":"inlineCode","value":"python","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"na0cbRchLf"},{"type":"text","value":", etc.) without bloating the core ","key":"fvJnYjz05f"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"U0G8cczbHt"}],"key":"OMarQaeP3W"},{"type":"text","value":" binary with language-specific compilation or logic.\nInitially, the ","key":"aumVgvUXgV"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"xRJT3U3w9u"},{"type":"text","value":" library directly depended on extension crates using hardcoded dispatch tables, which violated the stack-agnostic boundary of the core engine and prevented external developers from writing custom project extensions.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"SNw6SMEMR5"}],"key":"WyDFkbVout"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Decision","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xpYVy3Dpky"}],"identifier":"decision","label":"Decision","html_id":"decision","implicit":true,"key":"xYaEk4XU9W"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"We have decided to formalize an ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"tZUmpqCpUi"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"vCbcExaDzG"},{"type":"text","value":" trait and introduce dynamic runtime discovery.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"dXWOOB7Ug8"}],"key":"oMUcCqY1Ph"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Extension Trait","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LxbnxwvepV"}],"key":"CvlgPS49t5"},{"type":"text","value":": All extensions implement an ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"TIZq7gdG3J"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"vCbrnIOHF3"},{"type":"text","value":" trait offering ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"mJUaK184V1"},{"type":"inlineCode","value":"name()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"m0gs1vwtlG"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"uqMt3HSQmI"},{"type":"inlineCode","value":"capabilities()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"JmOqzzBXzs"},{"type":"text","value":", and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"jXb8oCLmv2"},{"type":"inlineCode","value":"build_action()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LkIu7DLaJA"},{"type":"text","value":". ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"QAjJhn0JRS"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LDlRiK4NHR"},{"type":"text","value":" completely drops dependencies on specific stack implementations (","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"kGCnb8xjOS"},{"type":"inlineCode","value":"devflow-ext-rust","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ylrwogYNpo"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"OBcW9yhM4y"},{"type":"inlineCode","value":"devflow-ext-node","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ljrzah7OXQ"},{"type":"text","value":").","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"yZRmM4Gttk"}],"key":"RvPexsGIez"}],"key":"UyYe1JL9iN"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Dynamic Boot Wiring","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"IR9EnzhQn0"}],"key":"YSQwe3N4TF"},{"type":"text","value":": At boot, ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"kY3Z2cNe71"},{"type":"inlineCode","value":"devflow-cli","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ifU98c9l1z"},{"type":"text","value":" dynamically instantiates extensions and places them into an ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Ck3XuR6ZEE"},{"type":"inlineCode","value":"ExtensionRegistry","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"QNRok0gSGm"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"c5jOpzqnSb"}],"key":"yrXDgfUHZo"}],"key":"Qkol40E24L"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Subprocess Delegation","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"wYK0G6MuLo"}],"key":"IMhp56GG5E"},{"type":"text","value":": For extensions not built into the ","key":"TziwA44459"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"Ia3U5F5pIc"}],"key":"THnunflsWN"},{"type":"text","value":", Devflow will discover binaries in ","key":"S6PqpJuL3h"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"NIX148NaKA"},{"type":"text","value":" prefixed with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"hnFNtpSx58"},{"type":"inlineCode","value":"devflow-ext-","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"cApt4wnwAN"},{"type":"text","value":". It will probe these binaries by executing them with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"SwErgA7odL"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"DrybsuuwTe"},{"type":"text","value":", which returns a JSON array of supported capabilities.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"fVMVddniY3"}],"key":"qtL2GeZkJv"}],"key":"UXv9wDVdLl"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Execution Protocol","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"romJtWmhbL"}],"key":"nv9ySHERf3"},{"type":"text","value":": To execute a targeted command, the Core serialization engine pipes a standard JSON ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ERRvm3g5AQ"},{"type":"inlineCode","value":"CommandRef","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ZSV9QnJtXo"},{"type":"text","value":" to the external binary via standard IO ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"irGaEYDvOK"},{"type":"inlineCode","value":"stdin","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"BAXqkWyswF"},{"type":"text","value":" (using ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"wP7zw9qqjZ"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"UiD36RnApl"},{"type":"text","value":"). The binary returns an ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ueoiK8hUrV"},{"type":"inlineCode","value":"ExecutionAction","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"wehs769Nor"},{"type":"text","value":" (program and arguments) as JSON over ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"J4q8eHsEy9"},{"type":"inlineCode","value":"stdout","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"So8sEw5hIW"},{"type":"text","value":".","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"PSM1WkG4Jo"}],"key":"uvjkrSoPSe"}],"key":"Sg9rGT8aid"}],"key":"knEcHapwYZ"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Consequences","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"xCvdFfZ68K"}],"identifier":"consequences","label":"Consequences","html_id":"consequences","implicit":true,"key":"zfdjuTy04O"},{"type":"heading","depth":4,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Positive","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"QSZSd3idvT"}],"identifier":"positive","label":"Positive","html_id":"positive","implicit":true,"key":"Ogqiawqp9a"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"q39HU12qk9"},{"type":"text","value":" is purely an orchestration engine, completely uncoupled from language specifics.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"aqpM8lDFIn"}],"key":"UW9I4ZDr0X"}],"key":"ewjNomQ3jP"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Teams can write new Devflow extensions in ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"mSThsQ1XVe"},{"type":"emphasis","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"any language","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"EDy9JMEzan"}],"key":"sEzhsRwF4J"},{"type":"text","value":" (Go, Python, Bash) simply by writing a binary that responds to ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"f9NwcEWQyl"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"kp0P6e4o15"},{"type":"text","value":" and ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"FVDytvupFu"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"PfDRktbHHP"},{"type":"text","value":" with JSON.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"fjQgCm9ie6"}],"key":"HAtaeCby6v"}],"key":"gUGO4P8Evq"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Command mapping logic natively resides inside the specific technology stack crate instead of sprawling match statements inside ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"xFD63RqC3o"},{"type":"inlineCode","value":"devflow-cli/src/executor.rs","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"R88oExTVIo"},{"type":"text","value":".","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"E4gaX0jX03"}],"key":"vsUTlj7Vw9"}],"key":"fRRJPPEQrd"}],"key":"xsc7DiU02D"},{"type":"heading","depth":4,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Negative","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"nDikRsJj48"}],"identifier":"negative","label":"Negative","html_id":"negative","implicit":true,"key":"L72gH1j7j8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Serialization overhead when passing Command contexts to sub-processes.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"G0ZSSby8Bs"}],"key":"xodmyeREEX"}],"key":"O6xDOcNt4v"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reliance on ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"h6uQfEtatD"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"xRN1G5tYMq"},{"type":"text","value":" configurations means execution environments must be properly curated for subprocess discovery to succeed.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"EDNlYnWCUp"}],"key":"SkUBoA08ZD"}],"key":"Ucf8dyCEYJ"}],"key":"fYrx7xIxpu"}],"key":"s1PBtUYtNH"}],"key":"yh2gL0CR8V"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ADR-0002 Cache Strategy Across Host, Container, and CI","url":"/adr-0002-cache-strategy","group":"02 Design"},"next":{"title":"Development Workflow","url":"/workflow","group":"03 Development"}}},"domain":"http://localhost:3000"}