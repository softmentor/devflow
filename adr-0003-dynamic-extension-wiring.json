{"version":3,"kind":"Article","sha256":"3b02e00de715eedf9e2ebe22d21d8ab59ab4442ded23ad86953672b748164434","slug":"adr-0003-dynamic-extension-wiring","location":"/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","dependencies":[],"frontmatter":{"title":"ADR-0003 Dynamic Extension Wiring and Subprocess Execution","date":"2026-02-27","label":"devflow.developer-guide.design.adr-0003","authors":[{"nameParsed":{"literal":"Soft Mentor","given":"Soft","family":"Mentor"},"name":"Soft Mentor","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/softmentor/devflow","abbreviations":{"ADR":"Architecture Decision Record.","API":"Application Programming Interface.","CI":"Continuous Integration.","CLI":"Command Line Interface.","DAG":"Directed Acyclic Graph.","GHCR":"GitHub Container Registry.","PR":"Pull Request."},"numbering":{"title":{"offset":3}},"source_url":"https://github.com/softmentor/devflow/blob/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","edit_url":"https://github.com/softmentor/devflow/edit/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","exports":[{"format":"md","filename":"adr-0003-dynamic-extension-wiring.md","url":"/build/adr-0003-dynamic-ext-3c553d876d7b4dc2e55bdc785522224f.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"abbreviation","title":"Architecture Decision Record.","children":[{"type":"text","value":"ADR","key":"NDehkhJFlI"}],"key":"pQxC75T2Y7"},{"type":"text","value":"-0003: Dynamic Extension Wiring and Subprocess Execution","key":"D5Z3Qj14a8"}],"identifier":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","label":"ADR-0003: Dynamic Extension Wiring and Subprocess Execution","html_id":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","implicit":true,"key":"oA78QctYxq"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Context","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UW0JCW1QbW"}],"identifier":"context","label":"Context","html_id":"context","implicit":true,"key":"gaqTJhBLtr"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Devflow needs to support multiple language stacks (","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HZ9PY14Ygc"},{"type":"inlineCode","value":"rust","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ltZQAlmboN"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jQ1KIPAqjJ"},{"type":"inlineCode","value":"node","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RA8iXoUO2d"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ruSqrobgWd"},{"type":"inlineCode","value":"python","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"QZHyOeipPc"},{"type":"text","value":", etc.) without bloating the core ","key":"zq9Bfydn0v"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"tsxxjWOiAj"}],"key":"qGi2QKjExy"},{"type":"text","value":" binary with language-specific compilation or logic.\nInitially, the ","key":"Jld8Vv6DA5"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kU0If75uus"},{"type":"text","value":" library directly depended on extension crates using hardcoded dispatch tables, which violated the stack-agnostic boundary of the core engine and prevented external developers from writing custom project extensions.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"LaajCoZl4Q"}],"key":"bZj78aSnX6"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Decision","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZITsf5Mj0X"}],"identifier":"decision","label":"Decision","html_id":"decision","implicit":true,"key":"MZIHKSsJ22"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"We have decided to formalize an ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"gKleW5RGAf"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"o6eEhLIQBH"},{"type":"text","value":" trait and introduce dynamic runtime discovery.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"gyOQIncvbg"}],"key":"HOuJY4H0rQ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Extension Trait","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"i152b3AhXf"}],"key":"HK1hNjBhUh"},{"type":"text","value":": All extensions implement an ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"YyY6EI3aAP"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"chwcPsOrCr"},{"type":"text","value":" trait offering ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Frvb4H2hkQ"},{"type":"inlineCode","value":"name()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"A0ihblRyoo"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"fL7xPOZiLp"},{"type":"inlineCode","value":"capabilities()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"CN6w2texpm"},{"type":"text","value":", and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"uJnctbudie"},{"type":"inlineCode","value":"build_action()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"iPzJplloc8"},{"type":"text","value":". ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"S2v9RMAv1l"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"olK9g5rLZ4"},{"type":"text","value":" completely drops dependencies on specific stack implementations (","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"SVfNAs1klD"},{"type":"inlineCode","value":"devflow-ext-rust","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"WOkvRqyVYZ"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"EzdO53dFME"},{"type":"inlineCode","value":"devflow-ext-node","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Rd1cKDgDdt"},{"type":"text","value":").","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"mBhcwr1hNx"}],"key":"L1J7GkqeFG"}],"key":"ibNkR3cPVs"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Dynamic Boot Wiring","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"tOIACwKouh"}],"key":"hM7iZchSaB"},{"type":"text","value":": At boot, ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"M5uOzjA4Rs"},{"type":"inlineCode","value":"devflow-cli","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"B8yalg5VxO"},{"type":"text","value":" dynamically instantiates extensions and places them into an ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ONlOMTEx7q"},{"type":"inlineCode","value":"ExtensionRegistry","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"bk77spq8C7"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"e7jo5TNhmx"}],"key":"LzQ8f0f05q"}],"key":"VFULc6zYlJ"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Subprocess Delegation","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"WksvHlV9ea"}],"key":"EmsudmFkmj"},{"type":"text","value":": For extensions not built into the ","key":"SBrasgq6sf"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"r9048VBjiK"}],"key":"VsTCNPWjdX"},{"type":"text","value":", Devflow will discover binaries in ","key":"n1B63zSv1P"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"cr8DuqU4cS"},{"type":"text","value":" prefixed with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"yZnb0os9Gd"},{"type":"inlineCode","value":"devflow-ext-","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"acoN6Mjqnp"},{"type":"text","value":". It will probe these binaries by executing them with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"DmrcZ0Ln4V"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"yyrefwDS3n"},{"type":"text","value":", which returns a JSON array of supported capabilities.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"odBhqVHRjT"}],"key":"bk69fGo9Ud"}],"key":"ox24ePUwEy"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Execution Protocol","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Vouj3qEc0d"}],"key":"fK6qcSv4AW"},{"type":"text","value":": To execute a targeted command, the Core serialization engine pipes a standard JSON ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"WhtB1xMp6u"},{"type":"inlineCode","value":"CommandRef","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"BCfmwUbgEb"},{"type":"text","value":" to the external binary via standard IO ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"cMOfQSxrdV"},{"type":"inlineCode","value":"stdin","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"kNWg5wysjn"},{"type":"text","value":" (using ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"fWLExfEQtH"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"eACEj9Cjsn"},{"type":"text","value":"). The binary returns an ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"GqSOedSjj2"},{"type":"inlineCode","value":"ExecutionAction","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"LK7LRqjWLr"},{"type":"text","value":" (program and arguments) as JSON over ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"VdeZW5oaDp"},{"type":"inlineCode","value":"stdout","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"tQ1wkFHOas"},{"type":"text","value":".","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"V6jT4qdZ7d"}],"key":"mkulmgA8Ew"}],"key":"NDq0Vf05vi"}],"key":"kOOdgdvBP8"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Consequences","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ClqRDZxplN"}],"identifier":"consequences","label":"Consequences","html_id":"consequences","implicit":true,"key":"uKMXDBV7bd"},{"type":"heading","depth":4,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Positive","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"zl6B7Fz1nP"}],"identifier":"positive","label":"Positive","html_id":"positive","implicit":true,"key":"RqCVF1DwvR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"afvZf1qTb6"},{"type":"text","value":" is purely an orchestration engine, completely uncoupled from language specifics.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"GAJc9YZpCp"}],"key":"eiWT88hO0V"}],"key":"Ub4Fdqpe4x"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Teams can write new Devflow extensions in ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Jy1fscT2Yi"},{"type":"emphasis","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"any language","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"WIAHjYvJvY"}],"key":"coLAkRdch8"},{"type":"text","value":" (Go, Python, Bash) simply by writing a binary that responds to ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"i0nRXuT6bj"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Xz7662MJg3"},{"type":"text","value":" and ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"C64LAw16bJ"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"yoGVvat38A"},{"type":"text","value":" with JSON.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"YGc8iqsnNJ"}],"key":"C2lJNIHzp2"}],"key":"djOT9RBMpD"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Command mapping logic natively resides inside the specific technology stack crate instead of sprawling match statements inside ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"wacRE899N0"},{"type":"inlineCode","value":"devflow-cli/src/executor.rs","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"qKoPX87P3R"},{"type":"text","value":".","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"FpNZCT4Zb5"}],"key":"ukhXDXgRsH"}],"key":"nEwqSbip8V"}],"key":"uTujKW5w5q"},{"type":"heading","depth":4,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Negative","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"HH6Pru8Gij"}],"identifier":"negative","label":"Negative","html_id":"negative","implicit":true,"key":"zelUEREqEs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Serialization overhead when passing Command contexts to sub-processes.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"cavs7WAPdm"}],"key":"sSU75ABAuH"}],"key":"MU49clVULd"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reliance on ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"UGCmTYnAXC"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"FNmYAFaWc9"},{"type":"text","value":" configurations means execution environments must be properly curated for subprocess discovery to succeed.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"lvB69rRoTq"}],"key":"y1BAXsebfB"}],"key":"qPpojQKucI"}],"key":"POwtMwvPDE"}],"key":"PaqaG1AF5b"}],"key":"FoLBSwII70"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ADR-0002 Cache Strategy Across Host, Container, and CI","url":"/adr-0002-cache-strategy","group":"02 Design"},"next":{"title":"Development Workflow","url":"/workflow","group":"03 Development"}}},"domain":"http://localhost:3000"}