{"version":3,"kind":"Article","sha256":"3b02e00de715eedf9e2ebe22d21d8ab59ab4442ded23ad86953672b748164434","slug":"adr-0003-dynamic-extension-wiring","location":"/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","dependencies":[],"frontmatter":{"title":"ADR-0003 Dynamic Extension Wiring and Subprocess Execution","date":"2026-02-27","label":"devflow.developer-guide.design.adr-0003","authors":[{"nameParsed":{"literal":"Soft Mentor","given":"Soft","family":"Mentor"},"name":"Soft Mentor","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/softmentor/devflow","abbreviations":{"ADR":"Architecture Decision Record.","API":"Application Programming Interface.","CI":"Continuous Integration.","CLI":"Command Line Interface.","DAG":"Directed Acyclic Graph.","GHCR":"GitHub Container Registry.","PR":"Pull Request."},"numbering":{"title":{"offset":3}},"source_url":"https://github.com/softmentor/devflow/blob/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","edit_url":"https://github.com/softmentor/devflow/edit/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","exports":[{"format":"md","filename":"adr-0003-dynamic-extension-wiring.md","url":"/devflow/build/adr-0003-dynamic-ext-b7f516a21a991ffece5ac2eb948550e2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"abbreviation","title":"Architecture Decision Record.","children":[{"type":"text","value":"ADR","key":"UypiAtLPEr"}],"key":"CBtBkHvUGq"},{"type":"text","value":"-0003: Dynamic Extension Wiring and Subprocess Execution","key":"iS0apfDXiP"}],"identifier":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","label":"ADR-0003: Dynamic Extension Wiring and Subprocess Execution","html_id":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","implicit":true,"key":"HaSl3EuE6N"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Context","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HPLUEGTwXK"}],"identifier":"context","label":"Context","html_id":"context","implicit":true,"key":"bl7UaFKIYk"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Devflow needs to support multiple language stacks (","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Z44n6rCfT9"},{"type":"inlineCode","value":"rust","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kBHAPRc9W0"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YhorXRaBRq"},{"type":"inlineCode","value":"node","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cAtYku36lZ"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pNFMfHNGei"},{"type":"inlineCode","value":"python","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uXCDcYrIYF"},{"type":"text","value":", etc.) without bloating the core ","key":"joEJyd5OMP"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"QztlKojFlQ"}],"key":"oxhO35ZWiR"},{"type":"text","value":" binary with language-specific compilation or logic.\nInitially, the ","key":"qo6XiXcZPr"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ScH6hFs6cg"},{"type":"text","value":" library directly depended on extension crates using hardcoded dispatch tables, which violated the stack-agnostic boundary of the core engine and prevented external developers from writing custom project extensions.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"vrtCQymi1G"}],"key":"ENeg8wGE9b"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Decision","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"i0SatQbA1X"}],"identifier":"decision","label":"Decision","html_id":"decision","implicit":true,"key":"OyoSMoytiU"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"We have decided to formalize an ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"hYJB5PLRXj"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"dnVdW97YjU"},{"type":"text","value":" trait and introduce dynamic runtime discovery.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"WPimkLLb9q"}],"key":"Falj0kY5N9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Extension Trait","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"n2BqrtCbjD"}],"key":"GHjlKnKwAx"},{"type":"text","value":": All extensions implement an ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"C3iHOMBd4v"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ClY46kXcio"},{"type":"text","value":" trait offering ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"dTwYCSk5bW"},{"type":"inlineCode","value":"name()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"d4qmQ6BhzO"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"OwiWsLLIUg"},{"type":"inlineCode","value":"capabilities()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"yDuUsQRf9p"},{"type":"text","value":", and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"mfS36XvGkZ"},{"type":"inlineCode","value":"build_action()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Mgo51Dsjxq"},{"type":"text","value":". ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"wxG037rmk3"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Iqzab2H9dr"},{"type":"text","value":" completely drops dependencies on specific stack implementations (","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"I2YG37EqFz"},{"type":"inlineCode","value":"devflow-ext-rust","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"tSLTICgD2j"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"AoJtVYrAQY"},{"type":"inlineCode","value":"devflow-ext-node","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"tTxO3D2QyQ"},{"type":"text","value":").","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"nwuVG1tLPf"}],"key":"KLfzENpYuj"}],"key":"YBVep7q7RL"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Dynamic Boot Wiring","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"U1OxmYHPAf"}],"key":"sqEUDg0QFK"},{"type":"text","value":": At boot, ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ipYmiGLnhj"},{"type":"inlineCode","value":"devflow-cli","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"y10RSdjYKD"},{"type":"text","value":" dynamically instantiates extensions and places them into an ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"g2AFafYZF0"},{"type":"inlineCode","value":"ExtensionRegistry","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"C4CPiLaKfq"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"QcyiXIV6mH"}],"key":"kas6L2Xzz0"}],"key":"nSQ0XY0kr9"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Subprocess Delegation","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"wS5Fr38moi"}],"key":"VqPflr8Sap"},{"type":"text","value":": For extensions not built into the ","key":"kaZG4v1x3R"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"nCFWLaa9g9"}],"key":"jcT5OKYXjV"},{"type":"text","value":", Devflow will discover binaries in ","key":"T71J8REb70"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ZNuksSz8WH"},{"type":"text","value":" prefixed with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"bWbdcw6C9f"},{"type":"inlineCode","value":"devflow-ext-","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"IWBkobjsBa"},{"type":"text","value":". It will probe these binaries by executing them with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"AiCFP1kwJB"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"jAK74KvSY7"},{"type":"text","value":", which returns a JSON array of supported capabilities.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"OcgUZ4Nboj"}],"key":"xU7cg2yW73"}],"key":"zlsgEgtSKR"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Execution Protocol","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"U7jvSsmzY7"}],"key":"bQ5muqcUH9"},{"type":"text","value":": To execute a targeted command, the Core serialization engine pipes a standard JSON ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"k6dRU5f2Qf"},{"type":"inlineCode","value":"CommandRef","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"O6JTbPYQ1w"},{"type":"text","value":" to the external binary via standard IO ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"q3zkRmYWnq"},{"type":"inlineCode","value":"stdin","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"iGJzf3uRjJ"},{"type":"text","value":" (using ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"eF7ZAFmdWV"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"DhkOmBKp2J"},{"type":"text","value":"). The binary returns an ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"agRFX34UCg"},{"type":"inlineCode","value":"ExecutionAction","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"fCDVabeuKz"},{"type":"text","value":" (program and arguments) as JSON over ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"YM8aXNsvFU"},{"type":"inlineCode","value":"stdout","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"IMq6zMLPoV"},{"type":"text","value":".","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ZiSWZVRHEg"}],"key":"hwqVd0DzvC"}],"key":"yURWIgGEDM"}],"key":"H3pi83WhCK"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Consequences","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"fTnS5enJJr"}],"identifier":"consequences","label":"Consequences","html_id":"consequences","implicit":true,"key":"ybMJH9QmuH"},{"type":"heading","depth":4,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Positive","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"l68NsazCLs"}],"identifier":"positive","label":"Positive","html_id":"positive","implicit":true,"key":"AUwUTBMfPG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"z4FZxPziXH"},{"type":"text","value":" is purely an orchestration engine, completely uncoupled from language specifics.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"uTCYLCxFWA"}],"key":"sa53uUXkkm"}],"key":"iDHksHNdaQ"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Teams can write new Devflow extensions in ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"uEmQmWzvrP"},{"type":"emphasis","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"any language","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"IoMfCoxrMd"}],"key":"WBBs7ldumT"},{"type":"text","value":" (Go, Python, Bash) simply by writing a binary that responds to ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"sdaXV6Ry6H"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"hFoJ1Ou2zn"},{"type":"text","value":" and ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"gfu7knJrQ3"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"aygRioXG1g"},{"type":"text","value":" with JSON.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"JRYL1dsThP"}],"key":"QhLdCOasJL"}],"key":"Z4rQ4fN1y8"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Command mapping logic natively resides inside the specific technology stack crate instead of sprawling match statements inside ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"CWQqehq9Uf"},{"type":"inlineCode","value":"devflow-cli/src/executor.rs","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"tKadJe7PcK"},{"type":"text","value":".","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"rmVgWRTXwI"}],"key":"MjQTDRUTWi"}],"key":"mZUe7jwzxF"}],"key":"ycpYT06fqW"},{"type":"heading","depth":4,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Negative","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"C1g5iULAaa"}],"identifier":"negative","label":"Negative","html_id":"negative","implicit":true,"key":"tfJz7CHYz3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Serialization overhead when passing Command contexts to sub-processes.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"fxnStzxMzW"}],"key":"YVvJ9EfDlg"}],"key":"aFpzndmBBJ"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reliance on ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"E0U8PFjsK8"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"I9a4949Ov1"},{"type":"text","value":" configurations means execution environments must be properly curated for subprocess discovery to succeed.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"jbqr4Gqzmu"}],"key":"m2nW9fTKrr"}],"key":"beIX1CfBpI"}],"key":"C9GNDRYITd"}],"key":"ylkftCLeEn"}],"key":"rREI2KDjLD"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ADR-0002 Cache Strategy Across Host, Container, and CI","url":"/adr-0002-cache-strategy","group":"02 Design"},"next":{"title":"Development Workflow","url":"/workflow","group":"03 Development"}}},"domain":"http://localhost:3000"}