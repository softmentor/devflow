{"version":3,"kind":"Article","sha256":"3b02e00de715eedf9e2ebe22d21d8ab59ab4442ded23ad86953672b748164434","slug":"adr-0003-dynamic-extension-wiring","location":"/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","dependencies":[],"frontmatter":{"title":"ADR-0003 Dynamic Extension Wiring and Subprocess Execution","date":"2026-02-27","label":"devflow.developer-guide.design.adr-0003","authors":[{"nameParsed":{"literal":"Soft Mentor","given":"Soft","family":"Mentor"},"name":"Soft Mentor","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/softmentor/devflow","abbreviations":{"ADR":"Architecture Decision Record.","API":"Application Programming Interface.","CI":"Continuous Integration.","CLI":"Command Line Interface.","DAG":"Directed Acyclic Graph.","GHCR":"GitHub Container Registry.","PR":"Pull Request."},"numbering":{"title":{"offset":3}},"source_url":"https://github.com/softmentor/devflow/blob/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","edit_url":"https://github.com/softmentor/devflow/edit/main/docs/developer-guide/02-design/adr/adr-0003-dynamic-extension-wiring.md","exports":[{"format":"md","filename":"adr-0003-dynamic-extension-wiring.md","url":"/devflow/build/adr-0003-dynamic-ext-5b1d01ff86709cfa3796de28759fbc6a.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"abbreviation","title":"Architecture Decision Record.","children":[{"type":"text","value":"ADR","key":"TR6Qqi0sqx"}],"key":"cb9ZTxU9uk"},{"type":"text","value":"-0003: Dynamic Extension Wiring and Subprocess Execution","key":"jBfpX3JAMv"}],"identifier":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","label":"ADR-0003: Dynamic Extension Wiring and Subprocess Execution","html_id":"adr-0003-dynamic-extension-wiring-and-subprocess-execution","implicit":true,"key":"EecyL9Gvg6"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Context","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"iPJ4IsqCo8"}],"identifier":"context","label":"Context","html_id":"context","implicit":true,"key":"E64FBniUv2"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Devflow needs to support multiple language stacks (","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"rtMlXrM74O"},{"type":"inlineCode","value":"rust","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qHlF93DPyQ"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YFXWNhgpM5"},{"type":"inlineCode","value":"node","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"KRwKEuvMPE"},{"type":"text","value":", ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qBEmk3iK33"},{"type":"inlineCode","value":"python","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Ywv9KYVODH"},{"type":"text","value":", etc.) without bloating the core ","key":"mMg5gTWeLz"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"EUPzCmbez0"}],"key":"iX8qMTc8J3"},{"type":"text","value":" binary with language-specific compilation or logic.\nInitially, the ","key":"Nyv9HjCgzd"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"mFRdNV4VGT"},{"type":"text","value":" library directly depended on extension crates using hardcoded dispatch tables, which violated the stack-agnostic boundary of the core engine and prevented external developers from writing custom project extensions.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"sp0sCkc825"}],"key":"XSiWIO66uZ"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Decision","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"m8Yu1a9Fue"}],"identifier":"decision","label":"Decision","html_id":"decision","implicit":true,"key":"N6OBfnAsQc"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"We have decided to formalize an ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CnuoKNhq4d"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"RWHjycjes5"},{"type":"text","value":" trait and introduce dynamic runtime discovery.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"RCTihDayFx"}],"key":"sl4vREMF1g"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Extension Trait","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LCQcI2UOH3"}],"key":"Bf5G1gDeib"},{"type":"text","value":": All extensions implement an ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"vBW7iy28WO"},{"type":"inlineCode","value":"Extension","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Es774o72S3"},{"type":"text","value":" trait offering ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"O2tyDH6oau"},{"type":"inlineCode","value":"name()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KLGVGPh9HS"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"rVjQ83SJAo"},{"type":"inlineCode","value":"capabilities()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"xvXhNYMdVI"},{"type":"text","value":", and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"x1fAoX5vjr"},{"type":"inlineCode","value":"build_action()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"bcP3ONoWgM"},{"type":"text","value":". ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"m6wOuRXxt9"},{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"oVrPuXM0i6"},{"type":"text","value":" completely drops dependencies on specific stack implementations (","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"VtxuqJMiHv"},{"type":"inlineCode","value":"devflow-ext-rust","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"nPkjlfZ2iy"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"AtoCE9xm8h"},{"type":"inlineCode","value":"devflow-ext-node","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LKVe1MdRpP"},{"type":"text","value":").","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"QgY9vczf52"}],"key":"HgzO3Y3rrA"}],"key":"ZP9j67rIhe"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Dynamic Boot Wiring","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"SVLPQA3BCp"}],"key":"ZbAtFTEH00"},{"type":"text","value":": At boot, ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"hNkXkljiio"},{"type":"inlineCode","value":"devflow-cli","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"gietOYmGXV"},{"type":"text","value":" dynamically instantiates extensions and places them into an ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"UluDIOTojE"},{"type":"inlineCode","value":"ExtensionRegistry","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"NaZa7DO2O7"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ytMgVXARi2"}],"key":"NfBNIgRXTE"}],"key":"clj0uTpsCI"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Subprocess Delegation","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"uf1n3HaNbm"}],"key":"pQknOpNgp4"},{"type":"text","value":": For extensions not built into the ","key":"A4OHfVcbir"},{"type":"abbreviation","title":"Command Line Interface.","children":[{"type":"text","value":"CLI","key":"dxUsisfEcc"}],"key":"b6BQ1bDZ2J"},{"type":"text","value":", Devflow will discover binaries in ","key":"v8VsZc9X0N"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"PY1CUJQs1X"},{"type":"text","value":" prefixed with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"BTre3PC1hr"},{"type":"inlineCode","value":"devflow-ext-","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"vwSjwienZF"},{"type":"text","value":". It will probe these binaries by executing them with ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"dyvZwyf05m"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"CaE6ifijUs"},{"type":"text","value":", which returns a JSON array of supported capabilities.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"SpPN8y9Hoc"}],"key":"FPMzx2pToJ"}],"key":"J20clhUIJQ"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Execution Protocol","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Bneh7eqAxr"}],"key":"c1LKAmSBXv"},{"type":"text","value":": To execute a targeted command, the Core serialization engine pipes a standard JSON ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"IqRD9JeFIm"},{"type":"inlineCode","value":"CommandRef","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"opseoHZzRV"},{"type":"text","value":" to the external binary via standard IO ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"dc6tj3CNQ2"},{"type":"inlineCode","value":"stdin","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"S5Coryf55a"},{"type":"text","value":" (using ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ccIJhtbDOz"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"QcUocXrAQh"},{"type":"text","value":"). The binary returns an ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"mD0Qjt8pLn"},{"type":"inlineCode","value":"ExecutionAction","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"dgzMecFeEZ"},{"type":"text","value":" (program and arguments) as JSON over ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"nIlKo7ibfx"},{"type":"inlineCode","value":"stdout","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"OqPMloUUdp"},{"type":"text","value":".","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Rxu5NFzCk4"}],"key":"Jyy11s18rg"}],"key":"Z4tQoKBLwT"}],"key":"EGBMsQIxgy"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Consequences","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ar7aX4BRAi"}],"identifier":"consequences","label":"Consequences","html_id":"consequences","implicit":true,"key":"a6Hp9t3EK6"},{"type":"heading","depth":4,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Positive","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"GYO3MSufAu"}],"identifier":"positive","label":"Positive","html_id":"positive","implicit":true,"key":"kv7vorPkWi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"devflow-core","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"lLzSbIHj0h"},{"type":"text","value":" is purely an orchestration engine, completely uncoupled from language specifics.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"EZH0sAH76i"}],"key":"QkcXP5s6ov"}],"key":"Z5M3Nt2yUz"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Teams can write new Devflow extensions in ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ZLAlNR0sgD"},{"type":"emphasis","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"any language","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Ccn33DdAn6"}],"key":"HyIk91ZznK"},{"type":"text","value":" (Go, Python, Bash) simply by writing a binary that responds to ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ktKmxZnyYv"},{"type":"inlineCode","value":"--discover","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"PNn0SgVJcV"},{"type":"text","value":" and ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"NePW20hch0"},{"type":"inlineCode","value":"--build-action","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Ue4CHbPE7o"},{"type":"text","value":" with JSON.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"eYUKtn7b2x"}],"key":"NJg9hHVJED"}],"key":"cMoBfdfajl"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Command mapping logic natively resides inside the specific technology stack crate instead of sprawling match statements inside ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nr2v7Qb82w"},{"type":"inlineCode","value":"devflow-cli/src/executor.rs","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"QwFwP7z0Sr"},{"type":"text","value":".","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"lk7R7OiZ8u"}],"key":"yrJbAt29Qh"}],"key":"qZywGsWow9"}],"key":"aZRL1YwWwA"},{"type":"heading","depth":4,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Negative","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"iZzCWXF20p"}],"identifier":"negative","label":"Negative","html_id":"negative","implicit":true,"key":"L68ZbGjtgN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Serialization overhead when passing Command contexts to sub-processes.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"neBBXsFBAu"}],"key":"XjuC9DIbJW"}],"key":"wwXmaf7A4q"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reliance on ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"UVvt73Flra"},{"type":"inlineCode","value":"$PATH","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"jzbX3Kd1GR"},{"type":"text","value":" configurations means execution environments must be properly curated for subprocess discovery to succeed.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"za1z59Any3"}],"key":"qBor0ESKM1"}],"key":"tPigG3RNaw"}],"key":"k5OkRhY3H0"}],"key":"WV4pzOwobT"}],"key":"l7bNKR4u9B"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ADR-0002 Cache Strategy Across Host, Container, and CI","url":"/adr-0002-cache-strategy","group":"02 Design"},"next":{"title":"Development Workflow","url":"/workflow","group":"03 Development"}}},"domain":"http://localhost:3000"}